# 📅 Day 4 – Data Storage, Retention & Privacy Governance

---

## 🎯 Objective

Design a robust, secure, and privacy-compliant storage strategy for all location data collected during active and historical rides. Ensure efficient data lifecycle management that supports analytics, compliance, and safety investigations without violating user trust or regulatory laws.

---

## 🗂️ Storage Categories

| Data Type                | Description                                       | Storage Duration |
|--------------------------|---------------------------------------------------|------------------|
| **Live GPS Pings**       | Real-time driver location during a trip           | Short-term (TTL: 30 mins – 2 hrs) |
| **Trip Routes (Archived)**| Completed trip paths for playback and safety logs| Mid-term (7–30 days) |
| **Aggregated Heatmaps**  | Anonymized region demand maps                     | Long-term (3–12 months) |
| **Crash or Dispute Logs**| Only if issues are flagged during a trip          | Long-term (retention flag triggered) |

---

## 🧰 Data Storage Stack

| Component               | Tool / Strategy                                        |
|-------------------------|--------------------------------------------------------|
| **Real-Time Buffering** | Redis Streams, Kafka (short TTL topics)                |
| **Durable Storage**     | S3 (trip archives), MongoDB (trip metadata), PostgreSQL (trip logs) |
| **Cold Storage Tiering**| Glacier / Archive buckets for legal or flagged use cases|
| **Access Auditing**     | CloudTrail / custom audit services                    |

---

## 🔐 Privacy-First Design

### ✅ Data Anonymization

- Strip rider/driver identifiers before storing analytical data
- Replace with hashed session ID for correlation

### ✅ Access Control & Audit Trails

- Role-based access (RBAC): Only safety, legal, or admin teams can access historical GPS
- Access logs stored for 180 days minimum
- Multi-approval gates for accessing archived trip paths

### ✅ Retention Policies

| Data Use Case         | Retention Strategy                     |
|-----------------------|-----------------------------------------|
| Live trip monitoring  | Discard after ride + TTL (30 min – 1 hr) |
| Legal investigations  | Retain only if incident flagged         |
| Heatmap analytics     | Retain in aggregated form only          |
| User export requests  | GDPR/CCPA compliant data retrieval tools|

---

## 🧠 Design Challenges & Governance Strategies

| Challenge                    | Strategy                                                         |
|-----------------------------|------------------------------------------------------------------|
| Regulatory compliance (GDPR/CCPA) | On-demand user data deletion tools + subject access request portals |
| Storage bloat from unused pings | Time-to-live on Redis & Kafka; bucket archival on S3           |
| Sensitive location access by devs | Role-based access + 2FA + encrypted vaulting of logs          |
| Maintaining playback granularity | Sample rate tuning per device model and trip phase            |

---

## 🌍 Real-World Extensions

- **Geo-Fencing-Based Retention**: Retain data longer in high-risk zones (airports, stadiums).
- **Differential Privacy for Analytics**: Add statistical noise to usage patterns to protect user identities.
- **User-Controlled History View**: Let riders see their own trip map archive with export/delete option.
- **Retention Flags on Incidents**: Flag specific trip IDs for extended storage only if safety flag triggered.

---

## 🚗 Relevance to Bimride

| Requirement                  | Bimride Implementation                              |
|-----------------------------|-----------------------------------------------------|
| GDPR/CCPA readiness          | User data deletion, audit logs, retrieval systems   |
| Location storage minimization| TTL and anonymized retention workflows             |
| Safety support               | Store replays only when flagged for review         |
| Scalable storage             | S3 hot/cold tier + Redis/Kafka streaming ingestion |

---

## 📌 Deliverables for Day 4

- ✅ Designed multi-tiered storage pipeline for trip-related location data
- ✅ Defined retention durations and anonymization strategy
- ✅ Compliant with GDPR/CCPA & industry privacy standards
- ✅ Architected secure access system for internal teams
- ✅ Flag-based retention policy for incident-specific replays
